# GitHub Pages bootstrap for the GSEA Enrichment Gallery

This folder contains the lightweight viewer that serves the **PNG-based** enrichment gallery. The gallery HTML is produced by `create_interactive_gallery.py`, weighs ~4 MB when compressed, and is streamed directly from this repository so it stays well within GitHub Pages limits.

## Files

| File | Purpose |
| --- | --- |
| `index.html` | Presentation-friendly bootstrap page with loader UI. |
| `styles.css` | Minimal responsive styling. |
| `app.js` | Loads configuration, fetches the compressed gallery, decompresses it in the browser via [fflate](https://github.com/101arrowz/fflate), and streams it into the iframe. |
| `config.json` | Points to `assets/enrichment-gallery.html.gz`, the local PNG gallery payload. |
| `assets/enrichment-gallery.html.gz` | Gzipped PNG gallery generated by `create_interactive_gallery.py`. |
| `annotated_enplots_png/` | Published PNG assets copied from the generator (optional for direct download; the viewer uses the inline base64 PNGs). |

## Deployment workflow

1. **Regenerate the galleries**
   - Activate the `mus_musculus` conda environment (or any env with CairoSVG installed).
   - Run `python create_interactive_gallery.py` from the repo root. This rebuilds:
     - `enrichment_plots_gallery_interactive.html` (SVG-rich local version)
     - `enrichment_plots_gallery_interactive_png.html` (PNG-embedded web version)
     - `annotated_enplots_png/` and `docs/annotated_enplots_png/` for raw PNG access
2. **Refresh the compressed payload**
   - `gzip -c enrichment_plots_gallery_interactive_png.html > docs/assets/enrichment-gallery.html.gz`
3. **Verify configuration**
   - `config.json` already targets the local gzip asset; tweak `assetFriendlyName` if you want a different download label.
4. **Deploy to GitHub Pages**
   - Push the updated `docs/` folder to the branch that backs GitHub Pages (e.g., `main` with the `/docs` content root).
   - Enable Pages in **Settings → Pages**, selecting the branch and `/docs` folder.
5. **Share the Pages URL**
   - During the presentation, visitors load the Pages site. The viewer streams the 2.8 MB gzip, decompresses it client-side (~3.9 MB HTML), and renders it in an iframe. A direct download link is also provided for offline access.

## Device compatibility

- Modern Chromium (Chrome, Edge), WebKit (Safari), and Gecko (Firefox) browsers on desktop/mobile fully support the streaming + `fflate` decompression approach.
- Memory footprint is small: the gzip is ~2.8 MB and expands to ~3.9 MB HTML, which modern mobile browsers handle comfortably.
- The viewer falls back gracefully; if the fetch fails, attendees can tap **Retry** or use the direct **Download** link.
